<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">

<head>
    <!-- 页面meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title sec:authentication="name"></title>
    <meta name="description" content="AdminLTE2定制版">
    <meta name="keywords" content="AdminLTE2定制版">


    <link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css">
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.4.0/jquery.js"></script>

    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport">

  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
    <!-- 页面meta /-->
    <link rel="stylesheet" href="../plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../plugins/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../plugins/ionicons/css/ionicons.min.css">
    <link rel="stylesheet" href="../plugins/iCheck/square/blue.css">
    <link rel="stylesheet" href="../plugins/morris/morris.css">
    <link rel="stylesheet" href="../plugins/jvectormap/jquery-jvectormap-1.2.2.css">
    <link rel="stylesheet" href="../plugins/datepicker/datepicker3.css">
    <link rel="stylesheet" href="../plugins/daterangepicker/daterangepicker.css">
    <link rel="stylesheet" href="../plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css">
    <link rel="stylesheet" href="../plugins/datatables/dataTables.bootstrap.css">
    <link rel="stylesheet" href="../plugins/treeTable/jquery.treetable.css">
    <link rel="stylesheet" href="../plugins/treeTable/jquery.treetable.theme.default.css">
    <link rel="stylesheet" href="../plugins/select2/select2.css">
    <link rel="stylesheet" href="../plugins/colorpicker/bootstrap-colorpicker.min.css">
    <link rel="stylesheet" href="../plugins/bootstrap-markdown/css/bootstrap-markdown.min.css">
    <link rel="stylesheet" href="../plugins/adminLTE/css/AdminLTE.css">
    <link rel="stylesheet" href="../plugins/adminLTE/css/skins/_all-skins.min.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../plugins/ionslider/ion.rangeSlider.css">
    <link rel="stylesheet" href="../plugins/ionslider/ion.rangeSlider.skinNice.css">
    <link rel="stylesheet" href="../plugins/bootstrap-slider/slider.css">
    <link rel="stylesheet" href="../plugins/bootstrap-datetimepicker/bootstrap-datetimepicker.css">
    <style>
        .navbar-nav>li>a.dropdown-toggle{
    padding-top: 18px;
    padding-bottom: 20px;
}
.userB{border-top: 1px solid #efeff1;}
.breadBtn{
    background: #84a9fe;
    font-size: 14px;
    padding: 0 10px;
    display: inline-block;
    height: 30px;
    line-height: 30px;
    border-radius: 10px;
    margin-left: 15px;
    color: #fff;
}


.sidebar{background:url(../img/leftnavBg.png) 0 100% no-repeat;
    position: absolute;
    top: 0;
    left: 0;
    padding-top:60px;
    min-height: 100%;
    width: 230px;
    z-index: 810;}


    .infoAlign{
  text-align: center;
}
.el-button--primary {
    color: #fff;
    background-color: #409EFF;
    border-color: #409EFF;
}
.el-button--mini{
  font-size: 12px;
  border-radius: 3px;
}
.el-button {
  display: inline-block;
  line-height: 1;
  white-space: nowrap;
  cursor: pointer;
  background: #fff;
  border: 1px solid #dcdfe6;
  color: #606266;
  -webkit-appearance: none;
  text-align: center;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
  outline: 0;
  margin: 0;
  -webkit-transition: .1s;
  transition: .1s;
  font-weight: 500;
  padding: 8px 20px;
  font-size: 14px;
  border-radius: 4px;
}
.el-button--primary {
  color: #fff;
  background-color: #409EFF;
  border-color: #409EFF;
}
.input_inner {
    -webkit-appearance: none;
    background-color: #fff;
    background-image: none;
    border-radius: 4px;
    border: 1px solid #dcdfe6;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    color: #606266;
    display: inline-block;
    font-size: inherit;
    height: 35px;
    line-height: 35px;
    outline: 0;
    padding: 0 15px;
    -webkit-transition: border-color .2s cubic-bezier(.645,.045,.355,1);
    transition: border-color .2s cubic-bezier(.645,.045,.355,1);
    width: 200px;
}
.text_inner{
    /* display: block; */
    resize: vertical;
    padding: 5px 15px;
    line-height: 1.5;
    box-sizing: border-box;
    width: 500px;
    font-size: inherit;
    color: #606266;
    background-color: #fff;
    background-image: none;
    border: 1px solid #dcdfe6;
    border-radius: 4px;
    height: 150px;
}
.formInfo{
    padding: 50px 100px;
}
.formInfo li{
    padding: 5px 0;
    list-style: none;
}
.formInfo label{width: 200px;display:inline-block ;text-align: right;vertical-align: top;}
</style>
</head>

<body class="hold-transition skin-purple sidebar-mini">

    <div class="wrapper">

        <!-- 页面头部 -->
        <header class="main-header">


            <!-- Logo -->
            <a href="aindex.html" class="logo">
                <img src="../img/logo.png" class="user-image" alt="User Image">
            </a>


            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top">
                <!-- Sidebar toggle button-->
                <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                    <span class="sr-only">Toggle navigation</span>
                </a>
                <span class="navInfo">测试</span><span data-v-b50ef614="" class="breadBtn">体验版</span>
                <div class="navbar-custom-menu">
                    <ul class="nav navbar-nav">


                        <!-- User Account: style can be found in dropdown.less -->
                        <li class="dropdown user user-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <img src="../img/avatar2.png" class="user-image" alt="User Image">
                                <span class="hidden-xs"></span>
                            </a>
                            <ul class="dropdown-menu">
                                <!-- Menu Footer-->
                                <li class="user-footer">
                                    <div>
                                        <a href="#" class="">首页</a>
                                    </div>
                                    <div>
                                        <a href="#" class="">修改密码</a>
                                    </div>
                                    <div class="userB">
                                        <a href="#" class="">退出登录</a>
                                    </div>
                                </li>
                            </ul>
                        </li>

                    </ul>
                </div>
            </nav>
        </header>

        <!-- 页面头部 /-->

        <!-- 导航侧栏 -->
        <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">



                <!-- sidebar menu: : style can be found in sidebar.less -->
                <ul class="sidebar-menu">
                    <!-- <li class="header">菜单</li> -->

                    <li id="admin-index"><a href="ablank.html"><i class="fa fa-dashboard"></i> <span>首页</span></a></li>



                    <li class="treeview active">
                        <a href="#">
                            <i class="fa fa-edit"></i> <span>流程管理</span>
                            <span class="pull-right-container">
                                  <i class="fa fa-angle-left pull-right"></i>
                            </span>
                        </a>
                        <ul class="treeview-menu">
                            <li><a href="/all-admin-blank"> <i class="fa fa-circle-o"></i> 流程部署</a></li>
                            <li><a href="/pages/search-Process"><i class="fa fa-circle-o"></i> 查看流程</a></li>
                            <li><a href="/create"><i class="fa fa-circle-o"></i> 请假单</a></li>
                            <li><a href="/pages/disposeProcess"><i class="fa fa-circle-o"></i> 流程审批</a></li>
                        </ul>
                    </li>








                </ul>
            </section>
            <!-- /.sidebar -->
        </aside>



        <div class="content-wrapper">



            <!-- 正文区域 -->
            <section class="content">

                <div class="box box-primary">
                    <!-- <div class="box-header with-border">
                <h3 class="box-title">表单信息</h3>
            </div> -->
                    <!--<csrf request-matcher-ref="csrfSecurityRequestMatcher"/>-->
                    <div class="box-body">
                        <!-- Table row -->
                        <div class="row">
                            <div class="col-xs-12 table-responsive">
                                <div class="col-xs-12 table-responsive" >

                                    <table class="table table-striped">
                                        <thead>
                                        <tr>
                                            <td>任务id</td>
                                            <td>任务名称</td>
                                            <td>任务执行人</td>
                                            <td>流程定义key</td>
                                            <td>流程实例id</td>
                                            <td>处理流程</td>

                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr th:each="processDefinition:${list}">
                                            <td  name="workId" th:text="${processDefinition.id}"></td>
                                            <td  th:text="${processDefinition.name}"></td>
                                            <td th:text="${processDefinition.assignee}"></td>
                                            <td th:text="${processDefinition.taskDefinitionKey}"></td>
                                            <td  name="processInstanceId" th:text="${processDefinition.processInstanceId}"></td>
                                            <td ><p><button class="el-button el-button--primary el-button--mini" type="button" onclick="pass(this)">通过</button>
                                                <button class="el-button el-button--primary el-button--mini" type="button" onclick="noPass(this)">不通过</button></p>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <!-- /.col -->
                        </div>
                        <!-- /.row -->

                    </div>
                </div>

            </section>
            <!-- 正文区域 /-->

        </div>



        <!-- 底部导航 -->
<!--        <footer class="main-footer">-->
<!--            <div class="pull-right hidden-xs">-->
<!--                <b>Version</b> 1.0.8-->
<!--            </div>-->
<!--            <strong>Copyright &copy; 2014-2017 <a href="http://www.itcast.cn">研究院研发部</a>.</strong> All rights reserved.-->
<!--        </footer>-->
        <!-- 底部导航 /-->

    </div>


    <script src="../plugins/jQuery/jquery-2.2.3.min.js"></script>
    <script src="../plugins/jQueryUI/jquery-ui.min.js"></script>
    <script>
        $.widget.bridge('uibutton', $.ui.button);
    </script>
    <script src="../plugins/bootstrap/js/bootstrap.min.js"></script>
    <script src="../plugins/raphael/raphael-min.js"></script>
    <script src="../plugins/morris/morris.min.js"></script>
    <script src="../plugins/sparkline/jquery.sparkline.min.js"></script>
    <script src="../plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
    <script src="../plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
    <script src="../plugins/knob/jquery.knob.js"></script>
    <script src="../plugins/daterangepicker/moment.min.js"></script>
    <script src="../plugins/daterangepicker/daterangepicker.js"></script>
    <script src="../plugins/daterangepicker/daterangepicker.zh-CN.js"></script>
    <script src="../plugins/datepicker/bootstrap-datepicker.js"></script>
    <script src="../plugins/datepicker/locales/bootstrap-datepicker.zh-CN.js"></script>
    <script src="../plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
    <script src="../plugins/slimScroll/jquery.slimscroll.min.js"></script>
    <script src="../plugins/fastclick/fastclick.js"></script>
    <script src="../plugins/iCheck/icheck.min.js"></script>
    <script src="../plugins/adminLTE/js/app.min.js"></script>
    <script src="../plugins/treeTable/jquery.treetable.js"></script>
    <script src="../plugins/select2/select2.full.min.js"></script>
    <script src="../plugins/colorpicker/bootstrap-colorpicker.min.js"></script>
    <script src="../plugins/bootstrap-wysihtml5/bootstrap-wysihtml5.zh-CN.js"></script>
    <script src="../plugins/bootstrap-markdown/js/bootstrap-markdown.js"></script>
    <script src="../plugins/bootstrap-markdown/locale/bootstrap-markdown.zh.js"></script>
    <script src="../plugins/bootstrap-markdown/js/markdown.js"></script>
    <script src="../plugins/bootstrap-markdown/js/to-markdown.js"></script>
    <script src="../plugins/ckeditor/ckeditor.js"></script>
    <script src="../plugins/input-mask/jquery.inputmask.js"></script>
    <script src="../plugins/input-mask/jquery.inputmask.date.extensions.js"></script>
    <script src="../plugins/input-mask/jquery.inputmask.extensions.js"></script>
    <script src="../plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="../plugins/datatables/dataTables.bootstrap.min.js"></script>
    <script src="../plugins/chartjs/Chart.min.js"></script>
    <script src="../plugins/flot/jquery.flot.min.js"></script>
    <script src="../plugins/flot/jquery.flot.resize.min.js"></script>
    <script src="../plugins/flot/jquery.flot.pie.min.js"></script>
    <script src="../plugins/flot/jquery.flot.categories.min.js"></script>
    <script src="../plugins/ionslider/ion.rangeSlider.min.js"></script>
    <script src="../plugins/bootstrap-slider/bootstrap-slider.js"></script>
    <script src="../plugins/bootstrap-datetimepicker/bootstrap-datetimepicker.js"></script>
    <script src="../plugins/bootstrap-datetimepicker/locales/bootstrap-datetimepicker.zh-CN.js"></script>
    <!--<link rel="stylesheet" type="text/css" href="easyui/themes/mobile.css">-->

    <script>
        $(document).ready(function() {
            // 选择框
            $(".select2").select2();

            // WYSIHTML5编辑器
            $(".textarea").wysihtml5({
                locale: 'zh-CN'
            });
        });


        // 设置激活菜单
        function setSidebarActive(tagUri) {
            var liObj = $("#" + tagUri);
            if (liObj.length > 0) {
                // liObj.parent().parent().addClass("active");
                liObj.addClass("active");
            }
        }
        // $(document).ready(function() {
        //     console.log(token);
        //     console.log(header);
        //     setSidebarActive("admin-blank");
        // });
        var httpurl="/pages/confirmNodeProcess";
        var paramMap={};

        function pass(e) {
            paramMap['agree']="true";
            var tr = e.parentElement.parentElement.parentElement; //当前行元素
             console.log(tr);
            var index = 0 ;//当前行位于父元素得第几结点
            while ( (tr = tr.previousSibling) != null ){
                index++
            }
            console.log(index);
            var trData = [] ; //获取当前行的text
            $('table tr').eq(index).find('td').each(function(){
                trData.push($(this).text())
            });

            var datas ={
                    paramMap:paramMap,
                    workId: trData[2],
                    processInstanceId: trData[4],
                     nodeCode:trData[1]
             };

            $.ajax({
                url: httpurl,//请求的url地址
                contentType:'application/json',
                type: 'post',//设置请求的http方式，method也可以
                dataType: 'json',//将服务器端返回的数据直接认定为是这个格式，然后会做一些自动的处理(如果是json字符串，会自动转化为js对象),服务器返回的默认格式是text/html格式
                data: JSON.stringify(datas),
                success: function (data) {//请求成功之后执行的回调函数
                    console.log("222",data)

                },
                error: function (jqXHR, textStatus, errorThrown) {//请求失败之后执行的回调函数
                    console.log(errorThrown);
                }
            });
            window.location.href="disposeProcess";
        }


        function noPass(e) {
            paramMap['agree']="false";
            var tr = e.parentElement.parentElement.parentElement //当前行元素
            console.log(tr);
            var index = 0; //当前行位于父元素得第几结点
            while ( (tr = tr.previousSibling) != null ){
                index++
            }
            console.log(index);
            var trData = [] ; //获取当前行的text
            $('table tr').eq(index).find('td').each(function(){
                trData.push($(this).text())
            });

            var datas ={
                paramMap:paramMap,
                workId: trData[2],
                processInstanceId: trData[4],
                nodeCode:trData[1]
            };

            $.ajax({
                url: httpurl,//请求的url地址
                contentType:'application/json',
                type: 'post',//设置请求的http方式，method也可以
                dataType: 'json',//将服务器端返回的数据直接认定为是这个格式，然后会做一些自动的处理(如果是json字符串，会自动转化为js对象),服务器返回的默认格式是text/html格式
                data: JSON.stringify(datas),
                success: function (data) {//请求成功之后执行的回调函数
                    console.log("222",data)

                },
                error: function (jqXHR, textStatus, errorThrown) {//请求失败之后执行的回调函数
                    console.log(errorThrown);
                }
            });
            window.location.href="disposeProcess";
        }

    </script>
</body>

</html>